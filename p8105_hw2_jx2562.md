p8105_hw2_jx2562
================
Jingyi

``` r
library(tidyverse)
library(readxl)
```

## Problem 1

In this problem, we aim to merge three data sets, *pols-month.csv*,
*unemployment.csv*, and *snp.csv* into one.

Clean the *pols-month.csv*.

``` r
pm_df =
  read_csv("data/pols-month.csv") |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    month = as.numeric(month),
    year = as.numeric(year))|>
  pivot_longer(
    cols = starts_with("prez"),
    names_to = "president",
    names_prefix = "prez_",
    values_to = "party") |>
  filter(party != 0) |>
  select(-c(party, day)) |>
  arrange(year,month) |>
  mutate(month = month.abb[month]) |>
  janitor::clean_names()

head(pm_df)
```

    ## # A tibble: 6 × 9
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ## 1  1947 Jan        23      51     253      23      45     198 dem      
    ## 2  1947 Feb        23      51     253      23      45     198 dem      
    ## 3  1947 Mar        23      51     253      23      45     198 dem      
    ## 4  1947 Apr        23      51     253      23      45     198 dem      
    ## 5  1947 May        23      51     253      23      45     198 dem      
    ## 6  1947 Jun        23      51     253      23      45     198 dem

Clean the *snp.csv* with the similar process as above. Mainly focus on
the representation of date.

``` r
snp_df =
  read_csv("data/snp.csv") |>
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(
    month = as.numeric(month),
    year = as.numeric(year),
    year = ifelse(year > 25, 1900 + year, 2000 + year)) |>
  select(year, month, close) |>
  arrange(year,month) |>
  mutate(month = month.abb[month]) |>
  janitor::clean_names()

head(snp_df)
```

    ## # A tibble: 6 × 3
    ##    year month close
    ##   <dbl> <chr> <dbl>
    ## 1  1950 Jan    17.0
    ## 2  1950 Feb    17.2
    ## 3  1950 Mar    17.3
    ## 4  1950 Apr    18.0
    ## 5  1950 May    18.8
    ## 6  1950 Jun    17.7

Clean the *unemployment.csv* so that it could fit in the previous two
datasets.

``` r
uep_df =
  read_csv("data/unemployment.csv") |>
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |>
  janitor::clean_names()

head(uep_df)
```

    ## # A tibble: 6 × 3
    ##    year month unemployment
    ##   <dbl> <chr>        <dbl>
    ## 1  1948 Jan            3.4
    ## 2  1948 Feb            3.8
    ## 3  1948 Mar            4  
    ## 4  1948 Apr            3.9
    ## 5  1948 May            3.5
    ## 6  1948 Jun            3.6

Here the three data frames are all lead by year and month with a correct
order. Next, we merge the three data frames together.

``` r
crisis_df = pm_df |>
  left_join(snp_df) |>
  left_join(uep_df)

head(crisis_df)
```

    ## # A tibble: 6 × 11
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  1947 Jan        23      51     253      23      45     198 dem          NA
    ## 2  1947 Feb        23      51     253      23      45     198 dem          NA
    ## 3  1947 Mar        23      51     253      23      45     198 dem          NA
    ## 4  1947 Apr        23      51     253      23      45     198 dem          NA
    ## 5  1947 May        23      51     253      23      45     198 dem          NA
    ## 6  1947 Jun        23      51     253      23      45     198 dem          NA
    ## # ℹ 1 more variable: unemployment <dbl>

The **crisis_df** is combined by the three data frames, **pm_df**,
**snp_df**, and **uep_df**, by left_join(). In this way, all values in
the three data frames are kept. The merged data frame has *11* columns
and *822* rows. It has the variables **year, month, gov_gop, sen_gop,
rep_gop, gov_dem, sen_dem, rep_dem, president, close, unemployment**.
The recorded time of the data ranges from *1947-Jan* to *2015-Jun*.

The **pm_df** has *9* columns and *822* rows related to the number of
national politicians who are democratic or republican at any given time.
It contains variables **year, month, gov_gop, sen_gop, rep_gop, gov_dem,
sen_dem, rep_dem, president**. And the time ranges from *1947-Jan* to
*2015-Jun*.

The **snp_df** has *3* columns and *787* rows related to Standard &
Poor’s stock market index (S&P), often used as a representative measure
of stock market as a whole. It contains variables **year, month,
close**. And the time ranges from *1950-Jan* to *2015-Jul*.

The **uep_df** has *3* columns and *816* rows related the unemployment
rate at a given time. It contains variables **year, month,
unemployment**. And the time ranges from *1948-Jan* to *2015-Dec*.

## Problem 2

First, define a path to the dataset.

``` r
path_to_data = "./data/202207 Trash Wheel Collection Data.xlsx"
```

Read and clean the Mr. Trashwheel dataset.

``` r
mr_df = 
    read_xlsx(
        path = path_to_data,
        sheet = "Mr. Trash Wheel",
        range = cell_cols("A:N")) |>
    janitor::clean_names() |> 
    drop_na(dumpster) |>
  mutate(
    homes_powered = round(as.numeric(weight_tons)*500/30, 2),
    type = "Mr.",
    year = as.numeric(year)) |>
  select(-dumpster) 

head(mr_df)
```

    ## # A tibble: 6 × 14
    ##   month  year date                weight_tons volume_cubic_yards plastic_bottles
    ##   <chr> <dbl> <dttm>                    <dbl>              <dbl>           <dbl>
    ## 1 May    2014 2014-05-16 00:00:00        4.31                 18            1450
    ## 2 May    2014 2014-05-16 00:00:00        2.74                 13            1120
    ## 3 May    2014 2014-05-16 00:00:00        3.45                 15            2450
    ## 4 May    2014 2014-05-17 00:00:00        3.1                  15            2380
    ## 5 May    2014 2014-05-17 00:00:00        4.06                 18             980
    ## 6 May    2014 2014-05-20 00:00:00        2.71                 13            1430
    ## # ℹ 8 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, type <chr>

Read and clean the Professor Trashwheel dataset.

``` r
prof_df = 
    read_xlsx(
        path = path_to_data,
        sheet = "Professor Trash Wheel",
        range = cell_cols("A:M")) |>
    janitor::clean_names() |> 
    drop_na(dumpster) |>
  mutate(
    homes_powered = round(as.numeric(weight_tons)*500/30, 2),
    type = "Professor",
    year = as.numeric(year)) |>
  select(-dumpster)

head(prof_df)
```

    ## # A tibble: 6 × 13
    ##   month  year date                weight_tons volume_cubic_yards plastic_bottles
    ##   <chr> <dbl> <dttm>                    <dbl>              <dbl>           <dbl>
    ## 1 Janu…  2017 2017-01-02 00:00:00        1.79                 15            1950
    ## 2 Janu…  2017 2017-01-30 00:00:00        1.58                 15            9540
    ## 3 Febr…  2017 2017-02-26 00:00:00        2.32                 18            8350
    ## 4 Febr…  2017 2017-02-26 00:00:00        3.72                 15            8590
    ## 5 Febr…  2017 2017-02-28 00:00:00        1.45                 15            7830
    ## 6 March  2017 2017-03-30 00:00:00        1.71                 15            8210
    ## # ℹ 7 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   homes_powered <dbl>, type <chr>

Read and clean the Gwynnda Trashwheel dataset.

``` r
gwynnda_df = 
    read_xlsx(
        path = path_to_data,
        sheet = "Gwynnda Trash Wheel",
        range = cell_cols("A:K")) |>
    janitor::clean_names() |> 
    drop_na(dumpster) |>
  mutate(
    homes_powered = round(as.numeric(weight_tons)*500/30, 2),
    type = "Gwynnda",
    year = as.numeric(year)) |>
  select(-dumpster)

head(prof_df)
```

    ## # A tibble: 6 × 13
    ##   month  year date                weight_tons volume_cubic_yards plastic_bottles
    ##   <chr> <dbl> <dttm>                    <dbl>              <dbl>           <dbl>
    ## 1 Janu…  2017 2017-01-02 00:00:00        1.79                 15            1950
    ## 2 Janu…  2017 2017-01-30 00:00:00        1.58                 15            9540
    ## 3 Febr…  2017 2017-02-26 00:00:00        2.32                 18            8350
    ## 4 Febr…  2017 2017-02-26 00:00:00        3.72                 15            8590
    ## 5 Febr…  2017 2017-02-28 00:00:00        1.45                 15            7830
    ## 6 March  2017 2017-03-30 00:00:00        1.71                 15            8210
    ## # ℹ 7 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   homes_powered <dbl>, type <chr>

Merge the three data sets.

``` r
trashwheel_df = mr_df |>
  bind_rows(prof_df) |>
  bind_rows(gwynnda_df)

trashwheel_df =
  select(trashwheel_df, month:homes_powered, plastic_bags, type) |>
  arrange(year, month)

head(trashwheel_df)
```

    ## # A tibble: 6 × 15
    ##   month  year date                weight_tons volume_cubic_yards plastic_bottles
    ##   <chr> <dbl> <dttm>                    <dbl>              <dbl>           <dbl>
    ## 1 Augu…  2014 2014-08-04 00:00:00        4.39                 16            2140
    ## 2 Augu…  2014 2014-08-04 00:00:00        5.33                 17            1630
    ## 3 Augu…  2014 2014-08-13 00:00:00        3.58                 20            3640
    ## 4 Augu…  2014 2014-08-13 00:00:00        3.1                  17            1430
    ## 5 Augu…  2014 2014-08-19 00:00:00        1.77                 10             570
    ## 6 Dece…  2014 2014-12-01 00:00:00        1.81                 17            1370
    ## # ℹ 9 more variables: polystyrene <dbl>, cigarette_butts <dbl>,
    ## #   glass_bottles <dbl>, grocery_bags <dbl>, chip_bags <dbl>,
    ## #   sports_balls <dbl>, homes_powered <dbl>, plastic_bags <dbl>, type <chr>

This **trashwheel_df** merged information from the Mr., Professor and
Gwynnda Trashwheel trash collector in Baltimore, Maryland. The dataset
contains information on year, month, and trash collected, include some
specific kinds of trash. There are a total of *747* rows in our final
dataset. Additional data sheets include month precipitation data.

In these datasets:

- The variables in the final data frame **trashwheel_df** are **month,
  year, date, weight_tons, volume_cubic_yards, plastic_bottles,
  polystyrene, cigarette_butts, glass_bottles, grocery_bags, chip_bags,
  sports_balls, homes_powered, plastic_bags, type**.

- The duration of the data collected in the final data set is from
  *1900-01-20* to *2022-07-29*. By checking the *year* variable of the
  starting date, there are some errors in data collection. Despite the
  outlier, the corrected time duration is from *2014-08-04* to
  *2022-07-29*.

- The mean weight in tons of trash collected during these years is
  2249.26.

- The total weight of trash collected by Professor Trash Wheel is
  190.12.

- The total number of cigarette butts collected by Gwynnda Trash Wheel
  in July of 2021 is 16.3 thousands.

## Problem 3

First, we read and clean the baseline data.

``` r
baseline_df = 
  read_csv("data/MCI_baseline.csv", skip = 1,show_col_types = FALSE) |>
  janitor::clean_names()

baseline_filter = baseline_df |>
  mutate(
    sex = ifelse(sex == 1, "male", "female"),
    apoe4 = ifelse(apoe4 == 1, "carrier", "non-carrier"),
    age_at_onset = as.numeric(age_at_onset)
  ) |>
  filter(age_at_onset != ".")
```

    ## Warning: There was 1 warning in `mutate()`.
    ## ℹ In argument: `age_at_onset = as.numeric(age_at_onset)`.
    ## Caused by warning:
    ## ! NAs introduced by coercion

The samples are filtered by MCI development. Those participants who did
not have MCI by the date of latest record are discarded. The data has
features are stated below:

- In the beginning, a total of 483 participants was recruited, with 272
  males and 211 females.

- Among these participants, 97 participants developed MCI by the end of
  follow-up, with 51 males and 46 females.

- The average age of all data collected is 65.05. The average age of
  filtered samples when the study began is 65.61. The average MCI onset
  age is 70.26.

- The proportion of women as APOE4 carriers is 0.65
