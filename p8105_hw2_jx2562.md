p8105_hw2_jx2562
================
Jingyi

``` r
library(tidyverse)
options(max.print=15)
```

## Problem 1

In this problem, we aim to merge three data sets, *pols-month.csv*,
*unemployment.csv*, and *snp.csv* into one.

Clean the *pols-month.csv*.

``` r
pm_df =
  read_csv("data/pols-month.csv") |>
  separate(mon, into = c("year", "month", "day"), sep = "-") |>
  mutate(
    month = as.numeric(month),
    year = as.numeric(year))|>
  pivot_longer(
    cols = starts_with("prez"),
    names_to = "president",
    names_prefix = "prez_",
    values_to = "party") |>
  filter(party != 0) |>
  select(-c(party, day)) |>
  arrange(year,month) |>
  mutate(month = month.abb[month]) |>
  janitor::clean_names()

tail(pm_df)
```

    ## # A tibble: 6 × 9
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ## 1  2015 Jan        31      54     245      18      44     188 dem      
    ## 2  2015 Feb        31      54     245      18      44     188 dem      
    ## 3  2015 Mar        31      54     245      18      44     188 dem      
    ## 4  2015 Apr        31      54     244      18      44     188 dem      
    ## 5  2015 May        31      54     245      18      44     188 dem      
    ## 6  2015 Jun        31      54     246      18      44     188 dem

Clean the *snp.csv* with the similar process as above. Mainly focus on
the representation of date.

``` r
snp_df =
  read_csv("data/snp.csv") |>
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(
    month = as.numeric(month),
    year = as.numeric(year),
    year = ifelse(year > 25, 1900 + year, 2000 + year)) |>
  select(year, month, close) |>
  arrange(year,month) |>
  mutate(month = month.abb[month]) |>
  janitor::clean_names()

tail(snp_df)
```

    ## # A tibble: 6 × 3
    ##    year month close
    ##   <dbl> <chr> <dbl>
    ## 1  2015 Feb   2104.
    ## 2  2015 Mar   2068.
    ## 3  2015 Apr   2086.
    ## 4  2015 May   2107.
    ## 5  2015 Jun   2063.
    ## 6  2015 Jul   2080.

Clean the *unemployment.csv* so that it could fit in the previous two
datasets.

``` r
uep_df =
  read_csv("data/unemployment.csv") |>
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment"
  ) |>
  janitor::clean_names()

tail(uep_df)
```

    ## # A tibble: 6 × 3
    ##    year month unemployment
    ##   <dbl> <chr>        <dbl>
    ## 1  2015 Jul             NA
    ## 2  2015 Aug             NA
    ## 3  2015 Sep             NA
    ## 4  2015 Oct             NA
    ## 5  2015 Nov             NA
    ## 6  2015 Dec             NA

Here the three data frames are all lead by year and month with a correct
order. Next, we merge the three data frames together.

``` r
merge_df = pm_df |>
  full_join(snp_df) |>
  full_join(uep_df)

tail(merge_df)
```

    ## # A tibble: 6 × 11
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  2015 Jul        NA      NA      NA      NA      NA      NA <NA>      2080.
    ## 2  2015 Aug        NA      NA      NA      NA      NA      NA <NA>        NA 
    ## 3  2015 Sep        NA      NA      NA      NA      NA      NA <NA>        NA 
    ## 4  2015 Oct        NA      NA      NA      NA      NA      NA <NA>        NA 
    ## 5  2015 Nov        NA      NA      NA      NA      NA      NA <NA>        NA 
    ## 6  2015 Dec        NA      NA      NA      NA      NA      NA <NA>        NA 
    ## # ℹ 1 more variable: unemployment <dbl>

``` r
head(merge_df)
```

    ## # A tibble: 6 × 11
    ##    year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##   <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ## 1  1947 Jan        23      51     253      23      45     198 dem          NA
    ## 2  1947 Feb        23      51     253      23      45     198 dem          NA
    ## 3  1947 Mar        23      51     253      23      45     198 dem          NA
    ## 4  1947 Apr        23      51     253      23      45     198 dem          NA
    ## 5  1947 May        23      51     253      23      45     198 dem          NA
    ## 6  1947 Jun        23      51     253      23      45     198 dem          NA
    ## # ℹ 1 more variable: unemployment <dbl>
